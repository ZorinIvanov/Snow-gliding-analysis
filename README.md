# Snow gliding analysis
**Topic name:** Influence of environmental factors on snow gliding prior and after first snowfall event

**Written by:** Zorin Ivanov

**Supervision:** Prof. Dr. Georg Leitinger (UIBK), Dr. Peter HÃ¶ller (UIBK, BFW)
## Description
Welcome to my project. As the topic name suggests, my aim was to idenfify the driving environmental factors for the process of snow gliding. The process is not well understood, hence forecasting of snow gliding and glide avalanches is still not possible. In order to build a reliable predictive model or an early-warning-system in the future, good-quality data, obtained over many measurement seasons, is needed. For this project, I was handled an extensive raw data obtained from two weather stations measuring environmental factors, as well as gliding data obtained from field loggers that detect very small movements in the snowpack. Here I showcase a part of the process of analyzing the dataset, as well as the statistical methods, techniques and tools I have used.

For the sake of simplicity, I don't follow the typical academic protocol. Instead, I showcase the project in two parts:

1. **Data cleaning and preparation of the master dataset.**
2. **Analysis and visualization.**
## Tools, Languages and Libraries Used
* R (dplyr, padr, data.table, ggplot2, scales, patchwork, lubridate, cowplot)
* SPSS
* MS Excel

## Part 1: Data cleaning and preparation of the master dataset.
In this part I import the data from two weather stations (Station 1 and Station 2) and the loggers data. The main idea of this part is to end up having a single homogeneous data set containing all the data necessary for analysis. The raw output of the weather stations has a measurement every 10 minutes. For our purpose we decided that a daily time series is detailed enough, yet not overly complicated; hence all data was agregated to daily averages (where sensible) and/or sums, maximums, minimums. For more details, let's dive straight into the dataset.

First we import the two stations datasets. In these datasets the variables are already aggregated to a daily format, thus each row corresponds to a single day of measurements. The timeframe ranges from 01/01/2014 until the end of 2019. Station 1 is the more extensive dataset and ends on 03/12/2019 so we will use it as a template for creating the master dataset. However, it has a few data gaps in between. We use the `pad()` function from the `padr` library which fills in gaps in datetime variables. This way we end up with a uninterrupted dataset that has a row for each day between 01/01/2014 - 03/12/2019.
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/19204162b682a39c993bbbaf491881c6375fb412/snow_gliding_master_dataset.R#L1-L12

Let's have a look at the datasets:
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/19204162b682a39c993bbbaf491881c6375fb412/snow_gliding_master_dataset.R#L14
| X | Group.1    | Mean_snowheight | SH_max.Max_snowheight | SH_min.Min_snowheight | SH_sd.SD_snowheight | TS_0_mean.Mean_t_snow_0cm | TS_0_max.Max_t_snow_0cm | TS_0_min.Min_t_snow_0cm | TS_0_sd.SD_t_snow_0cm | TS_5_mean.Mean_t_snow_5cm | TS_5_max.Max_t_snow_5cm | TS_5_min.Min_t_snow_5cm | TS_5_sd.SD_t_snow_5cm | TS_50_mean.Mean_t_snow_50cm | TS_50_max.Max_t_snow_50cm | TS_50_min.Min_t_snow_50cm | TS_50_sd.SD_t_snow_50cm | TS_100_mean.Mean_t_snow_100cm | TS_100_max.Max_t_snow_100cm | TS_100_min.Min_t_snow_100cm | TS_100_sd.SD_t_snow_100cm | IC_mean.Mean_ice_content | IC_max.Max_ice_content | IC_min.Min_ice_content | IC_sd.SD_ice_content | WC_mean.Mean_water_content | WC_max.Max_water_content | WC_min.Min_water_content | WC_sd.SD_water_content | SD_mean.Mean_snow_density | SD_max.Max_snow_density | SD_min.Min_snow_density | SD_sd.SD_snow_density | date       |
|---|------------|-----------------|-----------------------|-----------------------|---------------------|---------------------------|-------------------------|-------------------------|-----------------------|---------------------------|-------------------------|-------------------------|-----------------------|-----------------------------|---------------------------|---------------------------|-------------------------|-------------------------------|-----------------------------|-----------------------------|---------------------------|--------------------------|------------------------|------------------------|----------------------|----------------------------|--------------------------|--------------------------|------------------------|---------------------------|-------------------------|-------------------------|-----------------------|------------|
| 1 | 01/01/2014 | 31.56041667     | 37.2                  | 24.1                  | 2.096424487         | -1.764583333              | -1.6                    | -1.9                    | 0.116155641           | -3.071527778              | -2.6                    | -3.4                    | 0.226454335           | -5.319444444                | 5.2                       | -9.6                      | 3.84651832              | -4.199305556                  | 4                           | -7.5                        | 2.488589246               | 4.447222222              | 8.7                    | 1                      | 2.869856468          | 1.6625                     | 3.5                      | 0.7                      | 0.732547523            | 57.3125                   | 104                     | 17                      | 32.69106692           | 01/01/2014 |
| 2 | 02/01/2014 | 31.13125        | 33.7                  | 28.5                  | 1.222828817         | -1.834722222              | -1.6                    | -1.9                    | 0.096309121           | -3.3875                   | -2.8                    | -3.9                    | 0.338832838           | -3.797222222                | -0.3                      | -8.4                      | 1.859804653             | -3.252777778                  | -0.5                        | -6.9                        | 1.585729386               | 10.15555556              | 13.7                   | 0.6                    | 4.147824061          | 2.641666667                | 3.4                      | 0.7                      | 0.84452163             | 119.4375                  | 159                     | 15                      | 46.43662028           | 02/01/2014 |
| 3 | 03/01/2014 | 31.14583333     | 32.4                  | 28                    | 1.121305121         | -1.777777778              | -1.6                    | -1.9                    | 0.120861965           | -2.8625                   | -2.6                    | -3.1                    | 0.17456239            | -4.238194444                | 3.6                       | -9                        | 3.512256194             | -2.597916667                  | 4                           | -6.6                        | 2.847682624               | 11.43958333              | 14.6                   | 9.1                    | 1.619557859          | 2.947222222                | 4.4                      | 2.2                      | 0.534141288            | 134.2916667               | 172                     | 107                     | 18.29818096           | 03/01/2014 |
| 4 | 04/01/2014 | 31.02430556     | 32.4                  | 29.4                  | 0.63126541          | -1.652777778              | -1.3                    | -1.8                    | 0.162129381           | -2.452083333              | -1.8                    | -2.7                    | 0.310643084           | -1.535416667                | 0                         | -4.8                      | 1.033729669             | -0.992361111                  | 2.2                         | -3.4                        | 1.274279166               | 13.93125                 | 19.7                   | 9                      | 3.304086657          | 3.14375                    | 5.8                      | 2.2                      | 0.679543116            | 158.9444444               | 238                     | 105                     | 36.03024716           | 04/01/2014 |
| 5 | 05/01/2014 | 26.74375        | 32.6                  | 12.5                  | 5.865159889         | -1.275                    | -1.2                    | -1.3                    | 0.043452409           | -1.770138889              | -1.7                    | -1.9                    | 0.073930473           | -3.770138889                | -0.4                      | -8.6                      | 2.264752101             | -4.233333333                  | 0.2                         | -8.8                        | 2.835193411               | 14.42430556              | 16.3                   | 12.6                   | 0.98805782           | 3.189583333                | 3.5                      | 2.6                      | 0.314391131            | 163.8125                  | 179                     | 143                     | 11.6216393            | 05/01/2014 |
| 6 | 06/01/2014 | 32.35069444     | 36.5                  | 23.8                  | 3.08726227          | -1.364583333              | -1.2                    | -1.5                    | 0.090429241           | -1.972222222              | -1.6                    | -2.2                    | 0.171967001           | -1.629166667                | 8                         | -10.5                     | 5.444736664             | -0.310416667                  | 9                           | -9.4                        | 5.562508348               | 9.538194444              | 14.9                   | 3.4                    | 5.09049569           | 2.704861111                | 5.1                      | 0.9                      | 1.206528272            | 114.4583333               | 171                     | 46                      | 56.66005549           | 06/01/2014 |

https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/19204162b682a39c993bbbaf491881c6375fb412/snow_gliding_master_dataset.R#L15
| X | Group.1    | x           | SH_max.x | SH_min.x | SH_sd.x     | T_mean.x     | T_max.x | T_min.x | T_sd.x      | Rad_mean.x  | Rad_max.x | Rad_min.x | Rad_sd.x    | Per_mean.x  | Per_max.x | Per_min.x | Per_sd.x    | Per_sum.x | date       | cum_rad     |
|---|------------|-------------|----------|----------|-------------|--------------|---------|---------|-------------|-------------|-----------|-----------|-------------|-------------|-----------|-----------|-------------|-----------|------------|-------------|
| 1 | 01/01/2014 | 100.3708333 | 101.4    | 96.7     | 0.80859673  | -2.102777778 | 0.5     | -4.7    | 1.330331703 | 46.27777778 | 242       | 0         | 80.68816296 | 0.243055556 | 3         | 0         | 0.545118551 | 35        | 01/01/2014 | 46.27777778 |
| 2 | 02/01/2014 | 101.0111111 | 101.8    | 100      | 0.45452059  | -1.310416667 | 0.9     | -4      | 1.247359098 | 28.6875     | 221       | 0         | 49.53355418 | 0.256944444 | 4         | 0         | 0.588307134 | 37        | 02/01/2014 | 74.96527778 |
| 3 | 03/01/2014 | 99.52708333 | 100.8    | 96.1     | 0.713135375 | 0.070833333  | 4       | -3.1    | 1.84826038  | 46          | 250       | 0         | 74.78771822 | 0.229166667 | 2         | 0         | 0.468873818 | 33        | 03/01/2014 | 120.9652778 |
| 4 | 04/01/2014 | 100.4       | 101.3    | 99.5     | 0.339635264 | 0.713286713  | 2.8     | -2.3    | 1.197899439 | 30.1958042  | 202       | 0         | 48.03025143 | 0.636363636 | 43        | 0         | 3.798712633 | 91        | 04/01/2014 | 151.161082  |
| 5 | 05/01/2014 | 100.5736111 | 104.7    | 98.5     | 1.093719266 | -2.807638889 | 2.4     | -6.1    | 3.208404171 | 19.00694444 | 91        | 0         | 28.3924782  | 1.708333333 | 65        | 0         | 9.06455095  | 246       | 05/01/2014 | 170.1680264 |
| 6 | 06/01/2014 | 103.425     | 104.5    | 100.8    | 0.962405204 | 1.376388889  | 7.3     | -6.2    | 4.558723078 | 51.85416667 | 260       | 0         | 89.05965383 | 0.256944444 | 2         | 0         | 0.483959886 | 37        | 06/01/2014 | 222.0221931 |

Now let's merge the two datasets. For that we use the `data.table` library. We convert the data frames into data tables and join them by using the date as a key.
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/19204162b682a39c993bbbaf491881c6375fb412/snow_gliding_master_dataset.R#L20-L25

Here is the resulting master dataset now:
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/19204162b682a39c993bbbaf491881c6375fb412/snow_gliding_master_dataset.R#L27
| X | Group.1    | x           | SH_max.x | SH_min.x | SH_sd.x     | T_mean.x     | T_max.x | T_min.x | T_sd.x      | Rad_mean.x  | Rad_max.x | Rad_min.x | Rad_sd.x    | Per_mean.x  | Per_max.x | Per_min.x | Per_sd.x    | Per_sum.x | date       | cum_rad     | i.X | i.Group.1  | Mean_snowheight | SH_max.Max_snowheight | SH_min.Min_snowheight | SH_sd.SD_snowheight | TS_0_mean.Mean_t_snow_0cm | TS_0_max.Max_t_snow_0cm | TS_0_min.Min_t_snow_0cm | TS_0_sd.SD_t_snow_0cm | TS_5_mean.Mean_t_snow_5cm | TS_5_max.Max_t_snow_5cm | TS_5_min.Min_t_snow_5cm | TS_5_sd.SD_t_snow_5cm | TS_50_mean.Mean_t_snow_50cm | TS_50_max.Max_t_snow_50cm | TS_50_min.Min_t_snow_50cm | TS_50_sd.SD_t_snow_50cm | TS_100_mean.Mean_t_snow_100cm | TS_100_max.Max_t_snow_100cm | TS_100_min.Min_t_snow_100cm | TS_100_sd.SD_t_snow_100cm | IC_mean.Mean_ice_content | IC_max.Max_ice_content | IC_min.Min_ice_content | IC_sd.SD_ice_content | WC_mean.Mean_water_content | WC_max.Max_water_content | WC_min.Min_water_content | WC_sd.SD_water_content | SD_mean.Mean_snow_density | SD_max.Max_snow_density | SD_min.Min_snow_density | SD_sd.SD_snow_density |
|---|------------|-------------|----------|----------|-------------|--------------|---------|---------|-------------|-------------|-----------|-----------|-------------|-------------|-----------|-----------|-------------|-----------|------------|-------------|-----|------------|-----------------|-----------------------|-----------------------|---------------------|---------------------------|-------------------------|-------------------------|-----------------------|---------------------------|-------------------------|-------------------------|-----------------------|-----------------------------|---------------------------|---------------------------|-------------------------|-------------------------------|-----------------------------|-----------------------------|---------------------------|--------------------------|------------------------|------------------------|----------------------|----------------------------|--------------------------|--------------------------|------------------------|---------------------------|-------------------------|-------------------------|-----------------------|
| 1 | 01/01/2014 | 100.3708333 | 101.4    | 96.7     | 0.80859673  | -2.102777778 | 0.5     | -4.7    | 1.330331703 | 46.27777778 | 242       | 0         | 80.68816296 | 0.243055556 | 3         | 0         | 0.545118551 | 35        | 01/01/2014 | 46.27777778 | 1   | 01/01/2014 | 31.56041667     | 37.2                  | 24.1                  | 2.096424487         | -1.764583333              | -1.6                    | -1.9                    | 0.116155641           | -3.071527778              | -2.6                    | -3.4                    | 0.226454335           | -5.319444444                | 5.2                       | -9.6                      | 3.84651832              | -4.199305556                  | 4                           | -7.5                        | 2.488589246               | 4.447222222              | 8.7                    | 1                      | 2.869856468          | 1.6625                     | 3.5                      | 0.7                      | 0.732547523            | 57.3125                   | 104                     | 17                      | 32.69106692           |
| 2 | 02/01/2014 | 101.0111111 | 101.8    | 100      | 0.45452059  | -1.310416667 | 0.9     | -4      | 1.247359098 | 28.6875     | 221       | 0         | 49.53355418 | 0.256944444 | 4         | 0         | 0.588307134 | 37        | 02/01/2014 | 74.96527778 | 2   | 02/01/2014 | 31.13125        | 33.7                  | 28.5                  | 1.222828817         | -1.834722222              | -1.6                    | -1.9                    | 0.096309121           | -3.3875                   | -2.8                    | -3.9                    | 0.338832838           | -3.797222222                | -0.3                      | -8.4                      | 1.859804653             | -3.252777778                  | -0.5                        | -6.9                        | 1.585729386               | 10.15555556              | 13.7                   | 0.6                    | 4.147824061          | 2.641666667                | 3.4                      | 0.7                      | 0.84452163             | 119.4375                  | 159                     | 15                      | 46.43662028           |
| 3 | 03/01/2014 | 99.52708333 | 100.8    | 96.1     | 0.713135375 | 0.070833333  | 4       | -3.1    | 1.84826038  | 46          | 250       | 0         | 74.78771822 | 0.229166667 | 2         | 0         | 0.468873818 | 33        | 03/01/2014 | 120.9652778 | 3   | 03/01/2014 | 31.14583333     | 32.4                  | 28                    | 1.121305121         | -1.777777778              | -1.6                    | -1.9                    | 0.120861965           | -2.8625                   | -2.6                    | -3.1                    | 0.17456239            | -4.238194444                | 3.6                       | -9                        | 3.512256194             | -2.597916667                  | 4                           | -6.6                        | 2.847682624               | 11.43958333              | 14.6                   | 9.1                    | 1.619557859          | 2.947222222                | 4.4                      | 2.2                      | 0.534141288            | 134.2916667               | 172                     | 107                     | 18.29818096           |
| 4 | 04/01/2014 | 100.4       | 101.3    | 99.5     | 0.339635264 | 0.713286713  | 2.8     | -2.3    | 1.197899439 | 30.1958042  | 202       | 0         | 48.03025143 | 0.636363636 | 43        | 0         | 3.798712633 | 91        | 04/01/2014 | 151.161082  | 4   | 04/01/2014 | 31.02430556     | 32.4                  | 29.4                  | 0.63126541          | -1.652777778              | -1.3                    | -1.8                    | 0.162129381           | -2.452083333              | -1.8                    | -2.7                    | 0.310643084           | -1.535416667                | 0                         | -4.8                      | 1.033729669             | -0.992361111                  | 2.2                         | -3.4                        | 1.274279166               | 13.93125                 | 19.7                   | 9                      | 3.304086657          | 3.14375                    | 5.8                      | 2.2                      | 0.679543116            | 158.9444444               | 238                     | 105                     | 36.03024716           |
| 5 | 05/01/2014 | 100.5736111 | 104.7    | 98.5     | 1.093719266 | -2.807638889 | 2.4     | -6.1    | 3.208404171 | 19.00694444 | 91        | 0         | 28.3924782  | 1.708333333 | 65        | 0         | 9.06455095  | 246       | 05/01/2014 | 170.1680264 | 5   | 05/01/2014 | 26.74375        | 32.6                  | 12.5                  | 5.865159889         | -1.275                    | -1.2                    | -1.3                    | 0.043452409           | -1.770138889              | -1.7                    | -1.9                    | 0.073930473           | -3.770138889                | -0.4                      | -8.6                      | 2.264752101             | -4.233333333                  | 0.2                         | -8.8                        | 2.835193411               | 14.42430556              | 16.3                   | 12.6                   | 0.98805782           | 3.189583333                | 3.5                      | 2.6                      | 0.314391131            | 163.8125                  | 179                     | 143                     | 11.6216393            |
| 6 | 06/01/2014 | 103.425     | 104.5    | 100.8    | 0.962405204 | 1.376388889  | 7.3     | -6.2    | 4.558723078 | 51.85416667 | 260       | 0         | 89.05965383 | 0.256944444 | 2         | 0         | 0.483959886 | 37        | 06/01/2014 | 222.0221931 | 6   | 06/01/2014 | 32.35069444     | 36.5                  | 23.8                  | 3.08726227          | -1.364583333              | -1.2                    | -1.5                    | 0.090429241           | -1.972222222              | -1.6                    | -2.2                    | 0.171967001           | -1.629166667                | 8                         | -10.5                     | 5.444736664             | -0.310416667                  | 9                           | -9.4                        | 5.562508348               | 9.538194444              | 14.9                   | 3.4                    | 5.09049569           | 2.704861111                | 5.1                      | 0.9                      | 1.206528272            | 114.4583333               | 171                     | 46                      | 56.66005549           |

The next step is to import the loggers. A raw logger data looks like this:

`head(logger_name, 10)`
| Date       | Time     | Time     | corImpulses | Distance | AccuDist |
|------------|----------|----------|-------------|----------|----------|
| 2.11.2015  | 0.691701 | 16:36:03 | 1           | 0.785    | 0.785    |
| 21.11.2015 | 0.287836 | 06:54:29 | 0           | 0.785    | 1.57     |
| 21.11.2015 | 0.392523 | 09:25:14 | 1           | 0.785    | 2.355    |
| 21.11.2015 | 0.445475 | 10:41:29 | 0           | 0.785    | 3.14     |
| 21.11.2015 | 0.542106 | 13:00:38 | 1           | 0.785    | 3.925    |
| 21.11.2015 | 0.589676 | 14:09:08 | 0           | 0.785    | 4.71     |
| 23.11.2015 | 0.513947 | 12:20:05 | 1           | 0.785    | 5.495    |
| 27.11.2015 | 0.202847 | 04:52:06 | 0           | 0.785    | 6.28     |
| 29.11.2015 | 0.869468 | 20:52:02 | 1           | 0.785    | 7.065    |
| 30.11.2015 | 0.950961 | 22:49:23 | 0           | 0.785    | 7.85     |

The logger stores impulses whenever it detects movement. Each impuse is equal to 0.785 mm of distance moved. It is important to mention that 0 and 1 in the "corImpulses" column does not say whether there is an impulse. In our case both are impulses so don't pay attention to this column. By design the loggers were mounted at the beginning of each season in three fall lines, each fall line consisting of 4-6 loggers. This means that we handle our logger data in groups organized by season (date) and by fall line. The aim in our next function is to import the loggers grouped by the fall line they are in, then to aggregate the distance data to daily sums (to fit the daily time series template of the master dataset) and finally to calculate the daily fall line distance average.
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/19204162b682a39c993bbbaf491881c6375fb412/snow_gliding_master_dataset.R#L31-L80

Here is a snippet of how the output looks like:
| date       | fall_line_mean |
|------------|----------------|
| 2015-11-02 | 0.785          |
| 2015-11-03 | 0.157          |
| 2015-11-04 | 0.000          |
| 2015-11-05 | 0.000          |
| 2015-11-06 | 0.000          |
| 2015-11-07 | 0.000          |
| 2015-11-08 | 0.157          |
| 2015-11-09 | 0.000          |
| 2015-11-10 | 0.000          |
| 2015-11-11 | 0.000          |

The next step is to repeat this for the other two fall lines of the 2015-16 winter season and do the same for the 2016-17, 2017-18, 2018-19 seasons. By the end of this we end up with daily averages for each fall line for each season, which we merge output row-wise by fall line. We join each fall line to the master dataset to adopt its frame. Finally, we calculate the overall distance average of the fall lines averages:
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/d7d164d4ffa2942bc3e300da6aaf251a8bc6136c/snow_gliding_master_dataset.R#L195-L215

This is how the master dataset looks like now:

`slice(master_dataset, 1110:1120)`  # fl_mean might appear as last column
| date       | fl3_mean | fl2_mean    | fl1_mean    | fl_mean     | X    | Group.1    | x           | SH_max.x | SH_min.x | SH_sd.x     | T_mean.x     | T_max.x | T_min.x | T_sd.x      | Rad_mean.x  | Rad_max.x | Rad_min.x | Rad_sd.x    | Per_mean.x  | Per_max.x | Per_min.x | Per_sd.x    | Per_sum.x | cum_rad     | i.X  | i.Group.1  | Mean_snowheight | SH_max.Max_snowheight | SH_min.Min_snowheight | SH_sd.SD_snowheight | TS_0_mean.Mean_t_snow_0cm | TS_0_max.Max_t_snow_0cm | TS_0_min.Min_t_snow_0cm | TS_0_sd.SD_t_snow_0cm | TS_5_mean.Mean_t_snow_5cm | TS_5_max.Max_t_snow_5cm | TS_5_min.Min_t_snow_5cm | TS_5_sd.SD_t_snow_5cm | TS_50_mean.Mean_t_snow_50cm | TS_50_max.Max_t_snow_50cm | TS_50_min.Min_t_snow_50cm | TS_50_sd.SD_t_snow_50cm | TS_100_mean.Mean_t_snow_100cm | TS_100_max.Max_t_snow_100cm | TS_100_min.Min_t_snow_100cm | TS_100_sd.SD_t_snow_100cm | IC_mean.Mean_ice_content | IC_max.Max_ice_content | IC_min.Min_ice_content | IC_sd.SD_ice_content | WC_mean.Mean_water_content | WC_max.Max_water_content | WC_min.Min_water_content | WC_sd.SD_water_content | SD_mean.Mean_snow_density | SD_max.Max_snow_density | SD_min.Min_snow_density | SD_sd.SD_snow_density |
|------------|----------|-------------|-------------|-------------|------|------------|-------------|----------|----------|-------------|--------------|---------|---------|-------------|-------------|-----------|-----------|-------------|-------------|-----------|-----------|-------------|-----------|-------------|------|------------|-----------------|-----------------------|-----------------------|---------------------|---------------------------|-------------------------|-------------------------|-----------------------|---------------------------|-------------------------|-------------------------|-----------------------|-----------------------------|---------------------------|---------------------------|-------------------------|-------------------------------|-----------------------------|-----------------------------|---------------------------|--------------------------|------------------------|------------------------|----------------------|----------------------------|--------------------------|--------------------------|------------------------|---------------------------|-------------------------|-------------------------|-----------------------|
| 14/01/2017 | 0        | 0.3925      | 0.261666667 | 0.218055556 | 1110 | 14/01/2017 | 135.8291667 | 150.5    | 124.2    | 7.587032321 | -12.16805556 | -10.4   | -14.1   | 1.09395368  | 46.45138889 | 338       | 0         | 81.67330708 | 0.5         | 4         | 0         | 0.860963844 | 72        | 74079.40863 | 1110 | 14/01/2017 | 71.6125         | 94.1                  | 63.4                  | 7.232346484         | -3.163194444              | -3                      | -3.3                    | 0.104276748           | -8.653472222              | -7.4                    | -10.1                   | 0.890738139           | -13.4                       | -9.9                      | -17.7                     | 1.839314253             | -13.67986111                  | -10.4                       | -17.1                       | 1.680100724               | 13.78263889              | 14                     | 13.5                   | 0.119046245          | 3.405555556                | 3.5                      | 3.3                      | 0.053907169            | 159.9097222               | 162                     | 158                     | 1.245485242           |
| 15/01/2017 | 0        | 0.3925      | 0.130833333 | 0.174444444 | 1111 | 15/01/2017 | 145.2347222 | 150.2    | 141.6    | 2.340800157 | -13.57222222 | -12.6   | -14.3   | 0.417023158 | 45.79166667 | 263       | 1         | 72.54609097 | 0.180555556 | 1         | 0         | 0.385992097 | 26        | 74125.2003  | 1111 | 15/01/2017 | 81.96597222     | 94.7                  | 70.4                  | 6.731671965         | -3.056944444              | -2.9                    | -3.1                    | 0.061054576           | -7.89375                  | -7.4                    | -8.4                    | 0.380691081           | -14.97291667                | -8.5                      | -18.3                     | 1.788041815             | -15.08333333                  | -10                         | -17.2                       | 1.340858717               | 14.09791667              | 14.4                   | 13.9                   | 0.148873979          | 3.46875                    | 3.6                      | 3.4                      | 0.057291733            | 163.6666667               | 167                     | 162                     | 1.754116039           |
| 16/01/2017 | 0.314    | 0.261666667 | 0.3925      | 0.322722222 | 1112 | 16/01/2017 | 140.5645833 | 143.7    | 137.5    | 1.593363367 | -14.80902778 | -12.8   | -16     | 0.870488424 | 48.46527778 | 322       | 1         | 78.47487801 | 0.243055556 | 2         | 0         | 0.461777166 | 35        | 74173.66558 | 1112 | 16/01/2017 | 70.62569444     | 80.4                  | 61.8                  | 4.82814804          | -2.9                      | -2.9                    | -2.9                    | 0                     | -7.551388889              | -7.3                    | -7.9                    | 0.229010065           | -16.66527778                | -12.7                     | -19.5                     | 1.590545468             | -16.86458333                  | -13.2                       | -19.1                       | 1.376855074               | 14.51111111              | 14.8                   | 14.2                   | 0.122965178          | 3.575694444                | 3.6                      | 3.5                      | 0.043042551            | 168.8402778               | 171                     | 165                     | 1.209884664           |
| 17/01/2017 | 0        | 0           | 0           | 0           | 1113 | 17/01/2017 | 140.8326389 | 148.8    | 134.4    | 4.225212865 | -14.98402778 | -9.2    | -16.5   | 1.758880095 | 69.65277778 | 445       | 1         | 116.9503104 | 0.222222222 | 1         | 0         | 0.417190813 | 32        | 74243.31835 | 1113 | 17/01/2017 | 72.53333333     | 79                    | 65.6                  | 3.136765962         | -2.9                      | -2.9                    | -2.9                    | 0                     | -7.096527778              | -6.7                    | -7.6                    | 0.3224498             | -15.84236111                | -9                        | -18.3                     | 2.630205923             | -16.50555556                  | -11.2                       | -18.5                       | 2.111267732               | 14.8625                  | 15.1                   | 14.6                   | 0.130021515          | 3.620138889                | 3.7                      | 3.5                      | 0.070542217            | 172.0416667               | 175                     | 170                     | 1.273039422           |
| 18/01/2017 | 0        | 0.261666667 | 0.130833333 | 0.130833333 | 1114 | 18/01/2017 | 122.6423611 | 142.8    | 112.7    | 7.528617476 | -12.8625     | -9.1    | -17.7   | 2.311263845 | 61.38888889 | 290       | 0         | 99.80751482 | 0.125       | 1         | 0         | 0.331873259 | 18        | 74304.70724 | 1114 | 18/01/2017 | 86.075          | 116.7                 | 50.7                  | 22.7258317          | -2.9                      | -2.9                    | -2.9                    | 0                     | -6.804861111              | -6.7                    | -6.9                    | 0.081360685           | -16.39444444                | -15.3                     | -17.1                     | 0.63010464              | -14.64652778                  | -9                          | -19.3                       | 3.202291863               | 15.28611111              | 15.7                   | 14.9                   | 0.184963089          | 3.697916667                | 3.8                      | 3.6                      | 0.030078568            | 176.8402778               | 180                     | 173                     | 1.736740756           |
| 19/01/2017 | 0        | 0.130833333 | 0           | 0.043611111 | 1115 | 19/01/2017 | 111.7548611 | 115      | 106.6    | 2.241341689 | -9.244444444 | -5.3    | -13.1   | 2.282673496 | 62.45138889 | 289       | 0         | 101.4136327 | 0.1875      | 2         | 0         | 0.409139469 | 27        | 74367.15863 | 1115 | 19/01/2017 | 103.4222222     | 108.1                 | 96.2                  | 2.450016254         | -2.85625                  | -2.8                    | -2.9                    | 0.049780989           | -6.392361111              | -6.1                    | -6.7                    | 0.164329475           | -13.43819444                | -10.4                     | -15.6                     | 1.994888452             | -10.00555556                  | 2.7                         | -15.3                       | 5.068065075               | 15.79236111              | 16.1                   | 15.4                   | 0.15603472           | 3.688888889                | 3.8                      | 3.6                      | 0.033681169            | 181.6319444               | 184                     | 178                     | 1.227576655           |
| 20/01/2017 | 0        | 0.261666667 | 0           | 0.087222222 | 1116 | 20/01/2017 | 109.8048611 | 111.8    | 106.4    | 1.254492897 | -5.529166667 | -3.6    | -9.1    | 1.000480654 | 62.35416667 | 296       | 0         | 103.4571949 | 0.152777778 | 2         | 0         | 0.379905112 | 22        | 74429.5128  | 1116 | 20/01/2017 | 103.2486111     | 105.6                 | 98.5                  | 1.640909952         | -2.698611111              | -2.6                    | -2.8                    | 0.064760032           | -5.69375                  | -5.4                    | -6.1                    | 0.167757213           | -11.68472222                | -8.3                      | -14                       | 2.021400174             | -8.484027778                  | 2.5                         | -13.5                       | 4.786456172               | 16.20763889              | 16.6                   | 15.9                   | 0.132791366          | 3.713194444                | 3.8                      | 3.6                      | 0.041386001            | 185.2152778               | 189                     | 183                     | 1.206991257           |
| 21/01/2017 | 0.157    | 0.130833333 | 0.130833333 | 0.139555556 | 1117 | 21/01/2017 | 110.3604167 | 111.3    | 108.6    | 0.606747462 | -2.659027778 | 0.4     | -5.3    | 1.59010987  | 63.79861111 | 301       | 0         | 105.9413071 | 0.159722222 | 1         | 0         | 0.367626948 | 23        | 74493.31141 | 1117 | 21/01/2017 | 101.3354167     | 103.8                 | 95.2                  | 1.862379437         | -2.529861111              | -2.5                    | -2.6                    | 0.045924628           | -5.09375                  | -4.8                    | -5.4                    | 0.14494694            | -9.997222222                | -6.1                      | -12.3                     | 2.132464494             | -6.163888889                  | 1.9                         | -11.3                       | 4.388583586               | 16.60555556              | 16.9                   | 16.3                   | 0.127250525          | 3.7375                     | 3.8                      | 3.6                      | 0.054033142            | 189.4305556               | 193                     | 187                     | 1.325662667           |
| 22/01/2017 | 0        | 0           | 0           | 0           | 1118 | 22/01/2017 | 110.9208333 | 111.9    | 109.6    | 0.514390807 | -0.540972222 | 0.4     | -1.7    | 0.501384544 | 64.07638889 | 301       | 0         | 106.2768571 | 0.152777778 | 1         | 0         | 0.361028919 | 22        | 74557.3878  | 1118 | 22/01/2017 | 99.51597222     | 101.9                 | 95.3                  | 1.844161575         | -2.477083333              | -2.4                    | -2.5                    | 0.04217637            | -4.55625                  | -4.2                    | -4.8                    | 0.139288276           | -8.681944444                | -4.1                      | -11.7                     | 2.677611209             | -3.709722222                  | 5.8                         | -8.8                        | 4.534472767               | 16.97222222              | 17.4                   | 16.7                   | 0.132456323          | 3.763194444                | 3.8                      | 3.7                      | 0.048395989            | 193.2361111               | 196                     | 191                     | 1.051047504           |
| 23/01/2017 | 0        | 0.130833333 | 0.261666667 | 0.130833333 | 1119 | 23/01/2017 | 109.5145833 | 111.1    | 106.9    | 0.984208798 | -2.004861111 | 0.2     | -3.7    | 0.917455425 | 65.28472222 | 305       | 0         | 107.8353876 | 0.145833333 | 1         | 0         | 0.354170952 | 21        | 74622.67252 | 1119 | 23/01/2017 | 97.79791667     | 101.7                 | 90.3                  | 2.965806739         | -2.272916667              | -2.2                    | -2.4                    | 0.049073585           | -4.022916667              | -3.6                    | -4.2                    | 0.167548657           | -8.230555556                | -2.6                      | -12.1                     | 3.158743615             | -5.356944444                  | 6.3                         | -10.5                       | 5.515479207               | 17.32847222              | 17.6                   | 17                     | 0.114454128          | 3.761111111                | 3.9                      | 3.7                      | 0.053035298            | 195.9375                  | 199                     | 194                     | 1.177996106           |
| 24/01/2017 | 0.314    | 0.130833333 | 0           | 0.148277778 | 1120 | 24/01/2017 | 108.9638889 | 110.5    | 103.1    | 1.673011234 | -4.889583333 | -0.1    | -7.5    | 1.619449909 | 66.1875     | 307       | 0         | 108.6718271 | 0.229166667 | 2         | 0         | 0.438030398 | 33        | 74688.86002 | 1120 | 24/01/2017 | 97.13333333     | 100.2                 | 90.3                  | 2.243685779         | -2.199305556              | -2.1                    | -2.2                    | 0.008333333           | -3.713194444              | -3.5                    | -3.9                    | 0.151563658           | -8.234027778                | -1                        | -13.1                     | 3.962607801             | -7.230555556                  | 3.2                         | -12                         | 5.161087295               | 17.63055556              | 17.9                   | 17.4                   | 0.120185043          | 3.758333333                | 3.9                      | 3.6                      | 0.081506789            | 198.8888889               | 202                     | 196                     | 1.639167071           |

Next we import the data from another measuring devices - the soil probes. There are two different measurements per site for each season - soil temperature and soil moisture at 4 different depths. There are two sites.
We clean doubled measurements and join corresponding datasets row-wise:
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/13bfc46064308904a97858d9e74078f1d7188938/snow_gliding_master_dataset.R#L218-L229

This is how the data looks like:

`head(brown15, 10)`
| date       | ST5_mean    | ST1.5_mean  | ST0_mean    | ST10_mean   |
|------------|-------------|-------------|-------------|-------------|
| 02/11/2015 | 7.947921053 | 8.2085      | 7.226703947 | 8.472618421 |
| 03/11/2015 | 5.431600694 | 5.044739583 | 6.364670139 | 5.641427083 |
| 04/11/2015 | 5.97903125  | 5.510364583 | 6.650083333 | 6.002170139 |
| 05/11/2015 | 5.708829861 | 5.264197917 | 5.854930556 | 5.880770833 |
| 06/11/2015 | 5.976239583 | 5.6201875   | 6.400802083 | 6.053222222 |
| 07/11/2015 | 6.023902778 | 5.784361111 | 6.993961806 | 6.159493056 |
| 08/11/2015 | 7.519923611 | 7.264107639 | 8.872145833 | 7.049736111 |
| 09/11/2015 | 6.683565972 | 6.414645833 | 6.311520833 | 6.849357639 |
| 10/11/2015 | 6.479642361 | 6.194618056 | 7.841371528 | 6.537697917 |
| 11/11/2015 | 6.376864583 | 5.976215278 | 5.826510417 | 6.56353125  |

We repeat this procedure for the other three datasets and then join them with the master dataset:
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/13bfc46064308904a97858d9e74078f1d7188938/snow_gliding_master_dataset.R#L231-L281

The master dataset has unimportant variables and unmeaningful names. Here we make the dataset more tidy:
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/13bfc46064308904a97858d9e74078f1d7188938/snow_gliding_master_dataset.R#L283-L362

We import and trim the precipitation data. Next we create daily average and sum aggregates. We add them to the master dataset:
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/13bfc46064308904a97858d9e74078f1d7188938/snow_gliding_master_dataset.R#L365-L390

Create daily average and sum aggregates for the snow pillows data. Create daily sum aggregate for the global radiation variable. Add them to the master dataset:
https://github.com/ZorinIvanov/Snow-gliding-analysis/blob/0933cd0be9ec0f24192258e77150ac1f49141af3/snow_gliding_master_dataset.R#L394-L417

Snippet of dataset after adding the soil probes, precipitation, snow pillows, global radiation data and removing unimportant variables:
`slice(master_dataset, 1110:1120)`
| date       | sum_rad | schneekissen_sum | schneekissen_mean | precipitation_sum | precipitation_mean | ST10_mean_lila | ST5_mean_lila | ST1.5_mean_lila | ST0_mean_lila | SWC5_mean_orange | SWC1.5_mean_orange | SWC0_mean_orange | SWC10_mean_orange | SWC1.5_mean_gelb | SWC0_mean_gelb | SWC10_mean_gelb | SWC5_mean_gelb | ST5_mean_brown | ST1.5_mean_brown | ST0_mean_brown | ST10_mean_brown | fl3_mean | fl2_mean    | fl1_mean    | snowheight_mean_north | air_temperature_mean_north | air_temperature_max_north | air_temperature_min_north | air_temperature_sd_north | rad_mean_north | rad_max_north | rad_min_north | rad_sd_north | precipitation_mean_north | precipitation_max_north | precipitation_min_north | precipitation_sd_north | precipitation_sum_north | radiation_cum | snowheight_mean_sma | water_content_mean_sma | water_content_max_sma | water_content_min_sma | water_content_sd_sma | fl_mean     |
|------------|---------|------------------|-------------------|-------------------|--------------------|----------------|---------------|-----------------|---------------|------------------|--------------------|------------------|-------------------|------------------|----------------|-----------------|----------------|----------------|------------------|----------------|-----------------|----------|-------------|-------------|-----------------------|----------------------------|---------------------------|---------------------------|--------------------------|----------------|---------------|---------------|--------------|--------------------------|-------------------------|-------------------------|------------------------|-------------------------|---------------|---------------------|------------------------|-----------------------|-----------------------|----------------------|-------------|
| 14/01/2017 | 6689    | 59330            | 412.0138889       | 6.7               | 0.279166667        | 0.218          | 0.051         | 0.105152778     | 0.005138889   | 0.15304375       | 0.1025             | NA               | 0.074550347       | 0.0673625        | NA             | 0.07381875      | 0.109575       | -0.043375      | -0.011388889     | -0.246444444   | 0.108847222     | 0        | 0.3925      | 0.261666667 | 135.8291667           | -12.16805556               | -10.4                     | -14.1                     | 1.09395368               | 46.45138889    | 338           | 0             | 81.67330708  | 0.5                      | 4                       | 0                       | 0.860963844            | 72                      | 74079.40863   | 71.6125             | 3.405555556            | 3.5                   | 3.3                   | 0.053907169          | 0.218055556 |
| 15/01/2017 | 6594    | 61066            | 424.0694444       | 0.7               | 0.029166667        | 0.218          | 0.051583333   | 0.107291667     | 0.031875      | 0.152698264      | 0.102501736        | NA               | 0.0743125         | 0.068253472      | NA             | 0.073891667     | 0.110191667    | -0.058444444   | -0.027916667     | -0.253541667   | 0.107           | 0        | 0.3925      | 0.130833333 | 145.2347222           | -13.57222222               | -12.6                     | -14.3                     | 0.417023158              | 45.79166667    | 263           | 1             | 72.54609097  | 0.180555556              | 1                       | 0                       | 0.385992097            | 26                      | 74125.2003    | 81.96597222         | 3.46875                | 3.6                   | 3.4                   | 0.057291733          | 0.174444444 |
| 16/01/2017 | 6979    | 60704            | 421.5555556       | 0.6               | 0.025              | 0.218          | 0.078805556   | 0.127611111     | 0.05090625    | 0.152607986      | 0.10253125         | NA               | 0.073783333       | 0.069108333      | NA             | 0.0739          | 0.110845833    | -0.059805556   | -0.029958333     | -0.251597222   | 0.106805556     | 0.314    | 0.261666667 | 0.3925      | 140.5645833           | -14.80902778               | -12.8                     | -16                       | 0.870488424              | 48.46527778    | 322           | 1             | 78.47487801  | 0.243055556              | 2                       | 0                       | 0.461777166            | 35                      | 74173.66558   | 70.62569444         | 3.575694444            | 3.6                   | 3.5                   | 0.043042551          | 0.322722222 |
| 17/01/2017 | 10030   | 63140            | 438.4722222       | 0                 | 0                  | 0.218          | 0.101555556   | 0.136069444     | 0.051         | 0.152470833      | 0.102538194        | NA               | 0.073070833       | 0.069977083      | NA             | 0.073952083     | 0.111583333    | -0.059902778   | -0.031027778     | -0.254708333   | 0.099027778     | 0        | 0           | 0           | 140.8326389           | -14.98402778               | -9.2                      | -16.5                     | 1.758880095              | 69.65277778    | 445           | 1             | 116.9503104  | 0.222222222              | 1                       | 0                       | 0.417190813            | 32                      | 74243.31835   | 72.53333333         | 3.620138889            | 3.7                   | 3.5                   | 0.070542217          | 0           |
| 18/01/2017 | 8840    | 58296            | 404.8333333       | 0                 | 0                  | 0.218097222    | 0.107         | 0.143069444     | 0.051         | 0.152226042      | 0.102734375        | NA               | 0.072384028       | 0.070701389      | NA             | 0.074414583     | 0.112368403    | -0.059708333   | -0.029861111     | -0.235652778   | 0.084055556     | 0        | 0.261666667 | 0.130833333 | 122.6423611           | -12.8625                   | -9.1                      | -17.7                     | 2.311263845              | 61.38888889    | 290           | 0             | 99.80751482  | 0.125                    | 1                       | 0                       | 0.331873259            | 18                      | 74304.70724   | 86.075              | 3.697916667            | 3.8                   | 3.6                   | 0.030078568          | 0.130833333 |
| 19/01/2017 | 8993    | 56238            | 390.5416667       | 0                 | 0                  | 0.219069444    | 0.107         | 0.158527778     | 0.051         | 0.152041667      | 0.102499306        | NA               | 0.0719375         | 0.071172917      | NA             | 0.0745          | 0.113170833    | -0.06          | -0.038027778     | -0.274541667   | 0.079388889     | 0        | 0.130833333 | 0           | 111.7548611           | -9.244444444               | -5.3                      | -13.1                     | 2.282673496              | 62.45138889    | 289           | 0             | 101.4136327  | 0.1875                   | 2                       | 0                       | 0.409139469            | 27                      | 74367.15863   | 103.4222222         | 3.688888889            | 3.8                   | 3.6                   | 0.033681169          | 0.043611111 |
| 20/01/2017 | 8979    | 55245            | 383.6458333       | 0                 | 0                  | 0.222375       | 0.107680556   | 0.162902778     | 0.057125      | 0.151347917      | 0.1025             | NA               | 0.071026042       | 0.07165          | NA             | 0.0745625       | 0.11410625     | -0.06          | -0.059319444     | -0.283         | 0.078805556     | 0        | 0.261666667 | 0           | 109.8048611           | -5.529166667               | -3.6                      | -9.1                      | 1.000480654              | 62.35416667    | 296           | 0             | 103.4571949  | 0.152777778              | 2                       | 0                       | 0.379905112            | 22                      | 74429.5128    | 103.2486111         | 3.713194444            | 3.8                   | 3.6                   | 0.041386001          | 0.087222222 |
| 21/01/2017 | 9187    | 54814            | 380.6527778       | 0                 | 0                  | 0.230152778    | 0.112152778   | 0.163           | 0.085513889   | 0.151            | 0.102491667        | NA               | 0.07009375        | 0.072180903      | NA             | 0.074930556     | 0.114902431    | -0.06          | -0.059027778     | -0.282416667   | 0.076180556     | 0.157    | 0.130833333 | 0.130833333 | 110.3604167           | -2.659027778               | 0.4                       | -5.3                      | 1.59010987               | 63.79861111    | 301           | 0             | 105.9413071  | 0.159722222              | 1                       | 0                       | 0.367626948            | 23                      | 74493.31141   | 101.3354167         | 3.7375                 | 3.8                   | 3.6                   | 0.054033142          | 0.139555556 |
| 22/01/2017 | 9227    | 53984            | 374.8888889       | 0                 | 0                  | 0.234625       | 0.121         | 0.163           | 0.099805556   | 0.151            | 0.1025             | NA               | 0.069372917       | 0.072602778      | NA             | 0.075           | 0.115641667    | -0.06          | -0.045513889     | -0.263069444   | 0.068208333     | 0        | 0           | 0           | 110.9208333           | -0.540972222               | 0.4                       | -1.7                      | 0.501384544              | 64.07638889    | 301           | 0             | 106.2768571  | 0.152777778              | 1                       | 0                       | 0.361028919            | 22                      | 74557.3878    | 99.51597222         | 3.763194444            | 3.8                   | 3.7                   | 0.048395989          | 0           |
| 23/01/2017 | 9401    | 53639            | 372.4930556       | 0                 | 0                  | 0.238611111    | 0.130333333   | 0.163           | 0.106611111   | 0.151            | 0.102654514        | NA               | 0.069291667       | 0.073041667      | NA             | 0.07503125      | 0.116279861    | -0.06          | -0.032680556     | -0.237013889   | 0.062277778     | 0        | 0.130833333 | 0.261666667 | 109.5145833           | -2.004861111               | 0.2                       | -3.7                      | 0.917455425              | 65.28472222    | 305           | 0             | 107.8353876  | 0.145833333              | 1                       | 0                       | 0.354170952            | 21                      | 74622.67252   | 97.79791667         | 3.761111111            | 3.9                   | 3.7                   | 0.053035298          | 0.130833333 |
| 24/01/2017 | 9531    | 54705            | 379.8958333       | 0                 | 0                  | 0.240166667    | 0.134319444   | 0.163           | 0.107         | 0.151110417      | 0.103              | NA               | 0.06929375        | 0.07335625       | NA             | 0.075216667     | 0.116898958    | -0.06          | -0.031513889     | -0.227         | 0.063152778     | 0.314    | 0.130833333 | 0           | 108.9638889           | -4.889583333               | -0.1                      | -7.5                      | 1.619449909              | 66.1875        | 307           | 0             | 108.6718271  | 0.229166667              | 2                       | 0                       | 0.438030398            | 33                      | 74688.86002   | 97.13333333         | 3.758333333            | 3.9                   | 3.6                   | 0.081506789          | 0.148277778 |

A fundamental part of the project was the analysis of the effect of environmental conditions before the first snowfall on snow gliding. For that, specific variables were designed where the selected variables were cumulatively summed for 1 month, 4 weeks, 3 weeks, 2 weeks, 1 week and 3 days before the formation of permanent snow cover. We will get in more detail about these variables but first we need to estimate when a permanent snow cover was formed. The conditions for the presence of permanent snow cover were 14 consecutive days of snow cover of more than 10 cm to ensure that we don't take into account small early snowfalls that melted quick. Here is the code, we end up with a vector containing the start date of permanent snow cover for each winter season of interest:
